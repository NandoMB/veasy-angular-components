"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(e){_defineProperty(n,e,r[e])})}return n}function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}angular.module("veasy.momentFormat").service("vMomentFormatService",function(){var e=["/","-",":",".",","," "],n=/[^\/-:.,\s]/gm,r=function(e){for(var n=[],r="",t="",i=0;i<e.length;i++){var o=e[i];u(o)?(t.length&&(r+=c(t.length),t=""),n.push({index:i,character:o}),r+=a(o)):t+=o}return t.length&&(r+=c(t.length)),{separators:n,regex:r=new RegExp("(".concat(r,")$"))}},u=function(n){return!!e.find(function(e){return e===n})},c=function(e){return"[0-9]{".concat(e,"}")},a=function(e){return"[".concat(e,"]")},t=function(e,n){return n.test(e)},i=function(e,n){return moment(e,n).isValid()},o=function(e,n){return 47<e&&e<58&&!n||95<e&&e<106&&!n},f=function(n){return!![37,39,91,8,46,32].find(function(e){return e===n})},l=function(e,n){var r=e.split("");return r[n.index]!==n.character&&r.splice(n.index,0,n.character),r.join("")};return{getOptions:function(e){var n=r(e);return _objectSpread({format:e,size:e.length},n)},isValid:function(e,n,r){return t(e,n)&&i(e,r)},isValidKeyCode:function(e,n){return o(e,n)||f(e)},getFieldPlaceholder:function(e){return e.replace(n,"_")},defineInputSize:function(e,n){return e.length>=n.size&&(e=e.slice(0,n.size)),e},applySeparators:function(n,e){var r=e.separators.filter(function(e){return e.index<=n.length-1}),t=!0,i=!1,o=void 0;try{for(var u,c=r[Symbol.iterator]();!(t=(u=c.next()).done);t=!0){var a=u.value;n=l(n,a)}}catch(e){i=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(i)throw o}}return n}}});
"use strict";angular.module("veasy.momentFormat").directive("vMomentFormat",["$timeout","vMomentFormatService",function(e,c){return{require:"ngModel",link:function(n,t,e,o){var r=c.getOptions(e.vMomentFormat),i=!1,a=function(){t.bind("blur",function(e){c.isValid(e.target.value,r.regex,r.format)||m()}),t.bind("keydown",function(e){var t=e.which||e.keyCode;i=8===t,c.isValidKeyCode(t,e.shiftKey)||e.preventDefault()})},u=function(){o.$parsers.push(function(e){return i||(e=c.defineInputSize(e,r),e=c.applySeparators(e,r)),t[0].value=e,e=moment(e,r.format),l(e),i=!1,e}),o.$formatters.push(function(e){return e&&"Invalid Date"!==e.toString()?(e=e?moment(e).format(r.format):e,l(e),e):""})},m=function(){o.$setViewValue(""),o.$setPristine()},f=function(e){t[0].placeholder=c.getFieldPlaceholder(e.format)},l=function(e,t){n.$emit("veasyMomentFormat:onChange",t)};a(),u(),f(r)}}}]);